<smz-label
  class="smz__input_name"
  [text]="input.name"
  [propertyName]="input.propertyName"
  [showLabel]="input.hideLabel != true"
  [warning]="input.warning">
</smz-label>

<!-- ZONA DE DROPPING -->
@if (input._file == null) {
  <div SmzDragDrop (fileDropped)="input.isDisabled ? notAllowed() : onFilesDropped($event, true, true, this.cdf)" class="file_upload__drag-container grid grid-nogutter items-center justify-center mt-1  mb-1">
    <div class="grid grid-nogutter flex-col items-center justify-center pt-3 pb-3">
      <!-- ICONE DE UPLOAD -->
      <i [ngClass]="input.dragIconClass" class="text-4xl mb-2"></i>
      <span class="grid grid-nogutter gap-2">
        <!-- INPUT DE UPLOAD MANUAL -->
        <input type="file" [name]="uploadControl" class="upload_manual_control" [attr.disabled]="input.isDisabled" [accept]="input.fileAccept" [id]="uploadControl" (change)="onInputFiles($event)" />
        <!-- BOTÃO PARA SELECIONAR ARQUIVO -->
        <label [for]="uploadControl" [ngClass]="{ 'text-gray-500' : input.isDisabled,'clickable upload_manual_label hvr hvr-grow': !input.isDisabled }">{{ input.inputMessage }}</label>
        <!-- MENSAGEM PARA ARRASTAR -->
        <span class="upload_field-drag-message">ou {{ input.dragMessage }}</span>
      </span>
      <!-- MENSAGEM DE ERRO PARA SELEÇÃO DE ARQUIVO -->
      @for (error of errors; track error) {
        <p-message [ngStyle]="{ 'width': '100%;' }" styleClass="dialog-messages">
          {{error}}
        </p-message>
      }
    </div>
  </div>
}

<!-- CONTEÚDO COM ARQUIVO CARREGADO -->
@if (input._file != null) {
  <div class="grid grid-nogutter items-center justify-start flex-nowrap mt-1 mb-1 file_upload-container">
    <div class="upload_field" [style.height]="input.thumbnailSize" [style.width]="input.thumbnailSize">
      @switch (input._fileType) {
        <!-- IMAGENS -->
        @case ('image') {
          <!-- THUMBNAIL DE IMAGENS -->
          @if (input.base64) {
            <img class="upload_field-img mr-3" [src]="input.base64 | safeUrl"/>
          }
          <!-- ZOOM PARA IMAGENS -->
          <div class="upload_field__actions">
            <div class="grid grid-nogutter items-center justify-end mr-2 mt-2">
              @if (input.allowZoom) {
                <i class="fa-solid fa-magnifying-glass-plus upload_field__actions_icon hvr hvr-grow text-white clickable" (click)="applyZoom()"></i>
              }
            </div>
          </div>
        }
        <!-- APLICAÇÕES -->
        @case ('application') {
          <div class="upload_field-generic h-full w-full grid grid-nogutter items-center text-5xl justify-center mr-3">
            <!-- THUMBNAIL DE APLICAÇÕES -->
            @switch (input._fileExtension) {
              @case ('.pdf') {
                <i class="fa-solid fa-file-pdf"></i>
              }
              @case ('.doc') {
                <i class="fa-solid fa-file-word"></i>
              }
              @case ('.docx') {
                <i class="fa-solid fa-file-word"></i>
              }
              @case ('.ppt') {
                <i class="fa-solid fa-file-powerpoint"></i>
              }
              @case ('.pptx') {
                <i class="fa-solid fa-file-powerpoint"></i>
              }
              @case ('.xls') {
                <i class="fa-solid fa-file-excel"></i>
              }
              @case ('.xlsx') {
                <i class="fa-solid fa-file-excel"></i>
              }
              @case ('.zip') {
                <i class="fa-solid fa-file-zipper"></i>
              }
              @case ('.7zip') {
                <i class="fa-solid fa-file-zipper"></i>
              }
              @case ('.rar') {
                <i class="fa-solid fa-file-zipper"></i>
              }
              @case ('.txt') {
                <i class="fa-solid fa-file-lines"></i>
              }
              @default {
                <i class="fa-solid fa-file"></i>
              }
            }
          </div>
          <!-- ZOOM PARA PDF -->
          @if (input._fileExtension === '.pdf') {
            <div class="upload_field__actions">
              <div class="grid grid-nogutter items-center justify-end mr-2 mt-2">
                @if (input.allowZoom) {
                  <i class="fa-solid fa-magnifying-glass-plus upload_field__actions_icon hvr hvr-grow text-white clickable" (click)="applyZoom()"></i>
                }
              </div>
            </div>
          }
        }
        <!-- VÍDEOS -->
        @case ('video') {
          <!-- THUMBNAIL DE VÍDEOS -->
          <div class="upload_field-generic h-full w-full grid grid-nogutter items-center text-5xl justify-center mr-3">
            <i class="fa-solid fa-file-video"></i>
          </div>
        }
        <!-- AUDIOS -->
        @case ('audio') {
          <!-- THUMBNAIL DE AUDIOS -->
          <div class="upload_field-generic h-full w-full grid grid-nogutter items-center text-5xl justify-center mr-3">
            <i class="fa-solid fa-file-audio"></i>
          </div>
        }
        <!-- OUTROS -->
        @default {
          <!-- THUMBNAIL GENERICOS -->
          <div class="upload_field-generic h-full w-full grid grid-nogutter items-center text-5xl justify-center mr-3">
            <i class="fa-solid fa-file"></i>
          </div>
        }
      }
    </div>
    <!-- NOME E TAMANHO DO ARQUIVO -->
    <div class="grid grid-nogutter flex-col items-start justify-end ml-3">
      <span>{{ input._file.name | fileNameShorten : input.shortenLength : input.shortenSeparator }} <i class="far fa-trash-alt hvr hvr-grow text-red-500 clickable ml-2 mb-1 cursor-pointer" (click)="clear(true)"></i></span>
      @if (input.showFileSize) {
        <span><small>{{ formatBytes(input._file.size) }}</small></span>
      }
    </div>
  </div>
}

<!-- MENSAGEM DE ERRO DE VALIDAÇÃO DO FORM -->
<smz-validation-messages [input]="input" [control]="control" [behaviors]="behaviors"></smz-validation-messages>

@if (isZoomActive) {
  <div class="upload_field__fullscreen-image">
    <!-- VISUALIZAÇÃO FULLSCREEN DE PDF -->
    @if (input._fileExtension === '.pdf') {
      @if (input.base64) {
        <iframe [src]="input.base64 | safeUrl" class="animate__animated animate__zoomIn animate__faster" width="100%" height="100%" frameborder="0"></iframe>
      }
    } @else {
      @if (input.base64) {
        <img class="animate__animated animate__zoomIn animate__faster" [src]="input.base64 | safeUrl" height="100%" width="100%"/>
      }
    }
    <!-- VISUALIZAÇÃO FULLSCREEN DE IMAGENS -->
    <!-- ICONE DE SAIR DO FULLSCREEN -->
    <i class="far fa-times-circle clickable m-4 hvr hvr-grow text-4xl text-white" (click)="restoreZoom()"></i>
  </div>
}